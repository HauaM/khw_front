<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>상담 상세 조회 - KWH 지식관리시스템</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: "Noto Sans KR", "Apple SD Gothic Neo", system-ui,
          -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        font-size: 14px;
        line-height: 1.5;
        color: #212121;
        background-color: #fafafa;
        높이: 100%;
      }
      *,
      *::before,
      *::after {
        box-sizing: inherit;
      }
      html {
        높이: 100%;
      } /* 앱 헤더 */
      .app-header {
        높이: 60px;
        배경색: #ffffff;
        테두리하단: 1px 단색 #e0e0e0;
        패딩: 0 24px;
        디스플레이: flex;
        정렬항목: 가운데 정렬;
        내용정렬: 공백;
      }
      .app-header-left h1 {
        여백: 0;
        글꼴크기: 18px;
        글꼴두께: 700;
        색상: #005bac;
      }
      .app-header-left p {
        여백: 0;
        글꼴크기: 12px;
        색상: #6e6e6e;
      }
      .app-header-right {
        디스플레이: flex;
        정렬항목: 가운데 정렬;
        간격: 12px;
        글꼴크기: 13px;
        색상: #424242;
      }
      .app-header-divider {
        색상: #bdbdbd;
      }
      .role-badge {
        디스플레이: 인라인 블록;
        배경색: #e8f1fb;
        색상: #1a73e8;
        테두리반경: 999px;
        글꼴크기: 11px;
        글꼴무게: 600;
        패딩: 2px 8px;
      }
      .btn-logout {
        배경색: #ffffff;
        색상: #005bac;
        테두리: 1px 단색 #005bac;
        테두리반경: 4px;
        패딩: 4px 12px;
        글꼴크기: 13px;
        글꼴무게: 600;
        커서: 포인터;
        전환: 배경색 0.2초;
      }
      .btn-logout:hover {
        배경색: #e8f1fb;
      } /* 레이아웃 컨테이너 */
      .app-container {
        display: flex;
        height: calc(100% - 60px);
      } /* 사이드바 */
      .app-sidebar {
        width: 240px;
        background-color: #f5f7fb;
        border-right: 1px solid #e0e0e0;
        overflow-y: auto;
        padding: 16px 0;
      }
      .menu-section {
        margin-bottom: 24px;
      }
      .menu-section-title {
        font-size: 11px;
        font-weight: 600;
        color: #6e6e6e;
        text-transform: uppercase;
        padding: 8px 16px;
        margin-bottom: 4px;
      }
      .menu-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        font-size: 14px;
        색상: #424242;
        커서: 포인터;
        전환: 모두 0.2초;
        텍스트장식: 없음;
        테두리왼쪽: 3px 단색 투명;
      }
      .menu-item:hover {
        배경색: #e8f1fb;
        색상: #005bac;
      }
      .메뉴 항목.활성 {
        배경색: #d2e4fa;
        색상: #005bac;
        테두리왼쪽 색상: #005bac;
        글꼴가중치: 600;
      }
      .menu-icon {
        너비: 18px;
        높이: 18px;
        flex-shrink: 0;
      } /* 주요 콘텐츠 */
      .main-content {
        flex: 1;
        overflow-y: auto;
        패딩: 24px;
      }
      .page-header {
        디스플레이: flex;
        justify-content: 간격;
        정렬-항목: flex-start;
        여백-아래쪽: 24px;
      }
      .page-header-left {
        flex: 1;
      }
      .page-title {
        글꼴크기: 24px;
        글꼴가중치: 700;
        색상: #212121;
        여백: 0 0 8px 0;
        줄높이: 1.4;
      }
      .page-subtitle {
        글꼴크기: 14px;
        색상: #6e6e6e;
        여백: 0;
      }
      .page-header-actions {
        디스플레이: flex;
        간격: 12px;
      } /* 세부 정보 카드 */
      .detail-card {
        배경색: #ffffff;
        테두리반경: 8px;
        상자그림자: 0px 1px 3px rgba(0, 0, 0, 0.08);
        패딩: 20px;
        최대너비: 1200px;
        여백하단: 16px;
      }
      .detail-section {
        여백하단: 24px;
      }
      .detail-section:last-child {
        여백하단: 0;
      }
      .detail-section-title {
        글꼴크기: 16px;
        글꼴무게: 600;
        색상: #212121;
        여백: 0 0 16px 0;
        패딩하단: 8px;
        테두리하단: 1px 단색 #e0e0e0;
        디스플레이: 플렉스;
        정렬-항목: 중앙;
        간격: 8px;
      }
      .섹션-아이콘 {
        너비: 20px;
        높이: 20px;
        색상: #005bac;
      }
      .디테일-그리드 {
        디스플레이: 그리드;
        그리드-템플릿-열: 반복(2, 1fr);
        간격: 16px;
      }
      .디테일-그리드.단일-열 {
        그리드-템플릿-열: 1fr;
      }
      .디테일-필드 {
        디스플레이: 플렉스;
        플렉스-방향: 열;
      }
      .디테일-필드.전체-폭 {
        그리드-열: 1 / -1;
      }
      .디테일-라벨 {
        글꼴-크기: 13px;
        글꼴-두께: 600;
        색상: #6e6e6e;
        여백-하단: 6px;
      }
      .detail-value {
        글꼴크기: 14px;
        색상: #212121;
        패딩: 8px 12px;
        배경색: #f5f7fb;
        테두리반경: 4px;
        테두리: 1px 단색 #e0e0e0;
        최소높이: 36px;
        디스플레이: flex;
        정렬항목: 가운데;
      }
      .detail-value.multiline {
        최소높이: 100px;
        정렬항목: flex-start;
        공백: 사전 래핑;
        줄높이: 1.6;
      }
      .detail-value.empty {
        색상: #9e9e9e;
        글꼴스타일: 기울임꼴;
      } /* 사업 유형 배지 */
      .business-type-badge {
        디스플레이: 인라인 플렉스;
        정렬항목: 가운데;
        패딩: 4px 12px;
        테두리반경: 4px;
        글꼴크기: 13px;
        글꼴두께: 600;
      }
      .business-type-badge.deposit {
        배경색: #e8f5e9;
        색상: #2e7d32;
      }
      .business-type-badge.loan {
        배경색: #fff3e0;
        색상: #f57c00;
      }
      .business-type-badge.card {
        배경색: #f3e5f5;
        색상: #7b1fa2;
      }
      .business-type-badge.교환 {
        배경색: #e3f2fd;
        색상: #1976d2;
      }
      .business-type-badge.internet {
        배경색: #e0f2f1;
        색상: #00796b;
      }
      .business-type-badge.mobile {
        배경색: #fce4ec;
        색상: #c2185b;
      }
      .business-type-badge.other {
        배경색: #eceff1;
        색상: #455a64;
      } /* 메타데이터 테이블 */
      .metadata-table-wrapper {
        overflow-x: auto;
      }
      .metadata-table {
        너비: 100%;
        테두리축소: 축소;
        글꼴크기: 14px;
      }
      .metadata-table thead {
        배경색: #f5f7fb;
      }
      .metadata-table th {
        텍스트정렬: 왼쪽;
        패딩: 10px 12px;
        글꼴-가중치: 600;
        색상: #424242;
        테두리-아래쪽: 2px 단색 #e0e0e0;
        글꼴-크기: 13px;
      }
      .metadata-table td {
        패딩: 10px 12px;
        테두리-아래쪽: 1px 단색 #e0e0e0;
        색상: #212121;
      }
      .metadata-table tbody tr:hover {
        배경색: #fafafa;
      }
      .metadata-table tbody tr:last-child td {
        테두리-아래쪽: 없음;
      }
      .metadata-key {
        글꼴-가중치: 600;
        색상: #005bac;
      }
      .empty-metadata {
        텍스트-정렬: 가운데;
        패딩: 32px;
        색상: #9e9e9e;
        글꼴-스타일: 기울임꼴;
      } /* 버튼 */
      .btn-primary {
        배경색: #005bac;
        색상: #ffffff;
        테두리: 없음;
        테두리반경: 6px;
        최소높이: 36px;
        패딩: 0 16px;
        글꼴크기: 14px;
        글꼴두께: 600;
        커서: 포인터;
        전환: 배경색 0.2초;
        디스플레이: 인라인 플렉스;
        정렬항목: 가운데;
        간격: 6px;
      }
      .btn-primary:hover:not(:disabled) {
        배경색: #00437f;
      }
      .btn-primary:disabled {
        배경색: #bdbdbd;
        커서: 허용되지 않음;
      }
      .btn-secondary {
        배경색: #ffffff;
        색상: #005bac;
        테두리: 1px 단색 #005bac;
        테두리반경: 6px;
        min-height: 36px;
        padding: 0 16px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      .btn-secondary:hover {
        background-color: #e8f1fb;
      }
      .btn-icon {
        width: 16px;
        height: 16px;
      } /* 스피너 로딩 */
      .spinner {
        display: inline-block;
        width: 16px;
        height: 16px;
        border: 2px solid #ffffff;
        border-top-color: transparent;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      } /* 토스트 알림 */
      .toast {
        position: fixed;
        top: 80px;
        오른쪽: 24px;
        배경색: #ffffff;
        테두리반경: 6px;
        상자그림자: 0px 4px 12px rgba(0, 0, 0, 0.15);
        패딩: 12px 16px;
        표시: 없음;
        정렬항목: 가운데;
        간격: 8px;
        z-인덱스: 2000;
        최소너비: 280px;
        border-left: 4px solid;
      }
      .toast.show {
        display: flex;
        animation: slideIn 0.3s ease-out;
      }
      .toast.success {
        border-left-color: #2e7d32;
      }
      .toast.error {
        border-left-color: #c62828;
      }
      .toast-icon {
        width: 20px;
        height: 20px;
        flex-shrink: 0;
      }
      .toast-message {
        flex: 1;
        font-size: 14px;
        color: #212121;
      }
      @keyframes slideIn {
        from {
          transform: translateX(400px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      } /* 정보 배너 */
      .info-banner {
        background-color: #e3f2fd;
        border-left: 4px solid #1976d2;
        border-radius: 4px;
        padding: 12px 16px;
        margin-bottom: 16px;
        display: flex;
        align-items: flex-start;
        gap: 12px;
      }
      .info-banner-icon {
        width: 20px;
        height: 20px;
        color: #1976d2;
        flex-shrink: 0;
        margin-top: 2px;
      }
      .info-banner-content {
        flex: 1;
      }
      .info-banner-title {
        font-size: 14px;
        font-weight: 600;
        color: #1565c0;
        margin: 0 0 4px 0;
      }
      .info-banner-text {
        font-size: 13px;
        color: #424242;
        margin: 0;
        line-height: 1.5;
      }
    </style>
    <style>
      @view-transition {
        탐색: 자동;
      }
    </style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
    <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  </head>
  <body>
    <!-- 앱 헤더 -->
    <header class="app-header">
      <div class="app-header-left">
        <h1>KWH 지식관리시스템</h1>
        <p>광주은행 헬프데스크 위키</p>
      </div>
      <div class="app-header-right">
        <span>디지털전략부</span> <span class="app-header-divider">·</span>
        <span>홍길동</span> <span class="app-header-divider">·</span>
        <span class="role-badge">상담사</span>
        <button class="btn-logout" onclick="handleLogout()">로그아웃</button>
      </div>
    </header>
    <!-- 앱 컨테이너 -->
    <div class="app-container">
      <!-- 사이드바 -->
      <aside class="app-sidebar">
        <nav>
          <div class="menu-section">
            <div class="menu-section-title">메인</div>
            <a href="#" class="menu-item">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
              </svg>
              대시보드
            </a>
          </div>
          <div class="menu-section">
            <div class="menu-section-title">상담 관리</div>
            <a href="#" class="menu-item">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M12 20h9"></path>
                <path
                  d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                ></path>
              </svg>
              상담 등록
            </a>
            <a href="#" class="menu-item active">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
              </svg>
              상담 검색
            </a>
          </div>
          <div class="menu-section">
            <div class="menu-section-title">메뉴얼 관리</div>
            <a href="#" class="menu-item">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                ></path>
                <polyline points="14 2 14 8 20 8"></polyline>
              </svg>
              메뉴얼 검색
            </a>
            <a href="#" class="menu-item">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              메뉴얼 버전 이력
            </a>
          </div>
          <div class="menu-section">
            <div class="menu-section-title">검토/승인</div>
            <a href="#" class="menu-item">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="9 11 12 14 22 4"></polyline>
                <path
                  d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"
                ></path>
              </svg>
              검토 작업 목록
            </a>
          </div>
          <div class="menu-section">
            <div class="menu-section-title">관리자</div>
            <a href="#" class="menu-item">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              사용자/권한 관리
            </a>
            <a href="#" class="menu-item">
              <svg
                class="menu-icon"
                viewbox="0 0 24 24"
                fill="none"
                스트로크="currentColor"
                스트로크-폭="2"
              >
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m-6-6H0m6 0h6m0-6h6m-6 6h6"></path>
              </svg>
              시스템 설정
            </a>
          </div>
        </nav>
      </aside>
      <!-- Main Content -->
      <main class="main-content">
        <div class="page-header">
          <div class="page-header-left">
            <h2 class="page-title">상담 상세 조회</h2>
            <p class="page-subtitle">
              등록된 상담 내용을 확인하고 메뉴얼을 생성할 수 있습니다
            </p>
          </div>
          <div class="page-header-actions">
            <button class="btn-secondary" onclick="handleBack()">
              <svg
                class="btn-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
              </svg>
              목록으로
            </button>
            <button
              class="btn-primary"
              id="createDraftBtn"
              onclick="handleCreateDraft()"
            >
              <svg
                class="btn-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                ></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="12" y1="18" x2="12" y2="12"></line>
                <line x1="9" y1="15" x2="15" y2="15"></line></svg
              ><span id="createDraftBtnText">메뉴얼 초안 생성</span>
            </button>
          </div>
        </div>
        <!-- Info Banner -->
        <div class="info-banner">
          <svg
            class="info-banner-icon"
            viewbox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          <div class="info-banner-content">
            <p class="info-banner-title">메뉴얼 초안 생성 안내</p>
            <p class="info-banner-text">
              이 상담 내용을 기반으로 AI가 메뉴얼 초안을 자동 생성합니다. 생성된
              초안은 검토자의 승인 후 최종 메뉴얼로 등록됩니다.
            </p>
          </div>
        </div>
        <!-- Detail Card: Basic Info -->
        <div class="detail-card">
          <div class="detail-section">
            <h3 class="detail-section-title">
              <svg
                class="section-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="8.5" cy="7" r="4"></circle>
                <polyline points="17 11 19 13 23 9"></polyline>
              </svg>
              기본 정보
            </h3>
            <div class="detail-grid">
              <div class="detail-field">
                <div class="detail-label">ID</div>
                <div class="detail-value" id="consultation_id">
                  CONS-1234567890
                </div>
              </div>
              <div class="detail-field">
                <div class="detail-label">등록일시</div>
                <div class="detail-value" id="created_at">
                  2024-01-15 14:32:05
                </div>
              </div>
              <div class="detail-field">
                <div class="detail-label">요청영업점</div>
                <div class="detail-value" id="branch_code">BR001 (본점)</div>
              </div>
              <div class="detail-field">
                <div class="detail-label">요청직원</div>
                <div class="detail-value" id="employee_id">
                  EMP1234 (홍길동)
                </div>
              </div>
              <div class="detail-field">
                <div class="detail-label">화면번호</div>
                <div class="detail-value" id="screen_id">SCR0001</div>
              </div>
              <div class="detail-field">
                <div class="detail-label">거래명</div>
                <div class="detail-value" id="transaction_name">
                  예금계좌 신규개설
                </div>
              </div>
              <div class="detail-field">
                <div class="detail-label">업무구분</div>
                <div class="detail-value" id="business_type">
                  <span class="business-type-badge deposit">예금</span>
                </div>
              </div>
              <div class="detail-field">
                <div class="detail-label">에러코드</div>
                <div class="detail-value" id="error_code">E001</div>
              </div>
            </div>
          </div>
        </div>
        <!-- 디테일 카드:Consultation Content -->
        <div class="detail-card">
          <div class="detail-section">
            <h3 class="detail-section-title">
              <svg
                class="section-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                ></path>
              </svg>
              상담 내용
            </h3>
            <div class="detail-grid single-column">
              <div class="detail-field">
                <div class="detail-label">문의내용</div>
                <div class="detail-value multiline" id="inquiry_text">
                  고객이 예금계좌 신규개설 화면(SCR0001)에서 계좌개설을 진행하던
                  중 E001 에러가 발생했습니다. 고객 정보는 정상적으로
                  입력되었으나 "주민등록번호 검증 실패" 메시지와 함께 다음
                  단계로 진행되지 않는 상황입니다.
                </div>
              </div>
              <div class="detail-field">
                <div class="detail-label">조치내용</div>
                <div class="detail-value multiline" id="action_taken">
                  주민등록번호 입력 필드를 재확인한 결과, 하이픈(-) 없이
                  13자리를 연속으로 입력하도록 안내했습니다. 고객이 하이픈을
                  포함하여 입력했던 것이 원인이었으며, 하이픈 제거 후 정상적으로
                  계좌개설이 완료되었습니다. 향후 동일한 문의를 방지하기 위해
                  입력 필드에 플레이스홀더 추가 및 자동 하이픈 제거 기능 개선을
                  건의했습니다.
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Detail Card: Metadata -->
        <div class="detail-card">
          <div class="detail-section">
            <h3 class="detail-section-title">
              <svg
                class="section-icon"
                viewbox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M12 2v20M2 12h20"></path>
                <circle cx="12" cy="12" r="10"></circle>
              </svg>
              추가 정보 (메타데이터)
            </h3>
            <div class="metadata-table-wrapper">
              <table class="metadata-table" id="metadataTable">
                <thead>
                  <tr>
                    <th style="width: 30%">키</th>
                    <th>값</th>
                  </tr>
                </thead>
                <tbody id="metadataTableBody">
                  <tr>
                    <td class="metadata-key">고객번호</td>
                    <td>1234567890</td>
                  </tr>
                  <tr>
                    <td class="metadata-key">고객등급</td>
                    <td>VIP</td>
                  </tr>
                  <tr>
                    <td class="metadata-key">상담채널</td>
                    <td>전화</td>
                  </tr>
                  <tr>
                    <td class="metadata-key">처리시간</td>
                    <td>약 10분</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </main>
    </div>
    <!-- 토스트 알림 -->
    <div class="toast" id="toast">
      <svg
        class="toast-icon"
        viewbox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        id="toastIcon"
      >
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline></svg
      ><span class="toast-message" id="toastMessage"></span>
    </div>
    <script>
      // 모의 상담 데이터(실제 앱에서는 API에서 가져옵니다) const consultationData = { id: 'CONS-1234567890', branch_code: 'BR001', branch_name: '본점', employee_id: 'EMP1234', employee_name: '홍길동', screen_id: 'SCR0001', transaction_name: '예금계새개설', business_type: 'DEPOSIT', error_code: 'E001', query_text: '귀하가 예금계좌새개설 화면(SCR0001)에서 유일하게 개설을 처리 중 E001이 발생했습니다. 고객 정보는 입력되었지만 "주민 등록 번호 인증 실패" 메시지와 함께 다음 단계로 처리되지 않는 상황입니다.', action_taken: '주민 등록 번호 입력 필드를 재확인한, 하이픈(-) 없이 13자리를 계속 입력하도록 했습니다. 프린터가 하이픈을 포함하여 입력했던 것이, 하이픈을 제거한 것도 마찬가지였습니다. 회원가입을 방지하기 위해 입력 필드에 플레이스홀더 추가 및 자동 하이픈 제거 기능 개선을 건의했습니다.',created_at: '2024-01-15T14:32:05',metadata_fields: { '고객번호': '1234567890', '고객등급': 'VIP', '상담채널': '전화', '처리시간': '약 10분' } }; // 비즈니스 유형 매핑 const businessTypeMap = { 'DEPOSIT': { label: '예금', class: 'deposit' }, 'LOAN': { label: '대출', class: 'loan' }, 'CARD': { label: '카드', class: 'card' }, 'EXCHANGE': { label: '환전', class: 'exchange' }, 'INTERNET': { label: '인터넷뱅킹', class: '인터넷' }, 'MOBILE': { 라벨: '모바일뱅킹', 클래스:'mobile' }, 'OTHER': { label: '기타', class: 'other' } }; // 데이터로 페이지 초기화 function initializePage() { // TODO: API Connect - GET /api/consultations/:id // 실제 앱에서 URL의 컨설팅 ID를 사용하여 API에서 데이터 가져오기 // 기본 정보 채우기 document.getElementById('consultation_id').textContent = consultationData.id; document.getElementById('created_at').textContent = formatDateTime(consultationData.created_at); document.getElementById('branch_code').textContent = `${consultationData.branch_code} (${consultationData.branch_name})`; document.getElementById('employee_id').textContent = `${consultationData.employee_id} (${consultationData.employee_name})`; document.getElementById('screen_id').textContent = consultationData.screen_id; document.getElementById('transaction_name').textContent = consultationData.transaction_name; document.getElementById('error_code').textContent = consultationData.error_code; // 배지로 비즈니스 유형 채우기 const businessType = businessTypeMap[consultationData.business_type]; document.getElementById('business_type').innerHTML = `<span class="business-type-badge ${businessType.class}">${businessType.label}</span>`; // 상담 내용 채우기 document.getElementById('inquiry_text').textContent = consultationData.inquiry_text; document.getElementById('action_taken').textContent = consultationData.action_taken; // 메타데이터 테이블 채우기 renderMetadataTable(consultationData.metadata_fields); } // 메타데이터 테이블 렌더링 function renderMetadataTable(metadataFields) { const tbody = document.getElementById('metadataTableBody'); if (!metadataFields || Object.keys(metadataFields).length === 0) { tbody.innerHTML = '<tr><td colspan="2" class="empty-metadata">추가 정보 없음</td></tr>'; return; } tbody.innerHTML = ''; Object.entries(metadataFields).forEach(([key, value]) => { const row = document.createElement('tr'); row.innerHTML = ` <td class="metadata-key">${escapeHtml(key)}</td> <td>${escapeHtml(value)}</td> `; tbody.appendChild(row); }); } // datetime 함수 형식 지정 formatDateTime(dateString) { const date = new Date(dateString); const year = date.getFullYear(); const month = String(date.getMonth() + 1).padStart(2, '0'); const day = String(date.getDate()).padStart(2, '0'); const hours = String(date.getHours()).padStart(2, '0'); const minutes = String(date.getMinutes()).padStart(2,'0'); const seconds = String(date.getSeconds()).padStart(2, '0'); return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`; } // XSS를 방지하기 위해 HTML을 이스케이프합니다. function escapeHtml(text) { const div = document.createElement('div'); div.textContent = text; return div.innerHTML; } // 초안 생성 버튼 비동기 처리 function handleCreateDraft() { const btn = document.getElementById('createDraftBtn'); const btnText = document.getElementById('createDraftBtnText'); // 버튼 비활성화 및 로딩 표시 btn.disabled = true; btnText.innerHTML = '<span class="spinner"></span> 생성 중...'; try { // TODO: API Connect - POST /api/manuals/draft // 요청 본문에는 consultation_id가 포함되어야 함 const requestBody = { consultation_id: consultationData.id, branch_code: consultationData.branch_code, screen_id: consultationData.screen_id, transaction_name: consultationData.transaction_name, business_type: consultationData.business_type, error_code: consultationData.error_code, inquiry_text: consultationData.inquiry_text, action_taken: consultationData.action_taken }; // API 호출 시뮬레이션 await new Promise(resolve => setTimeout(resolve, 2000)); // 모의 응답 const response = { success: true, data: { manual_draft_id: 'DRAFT-' + Date.now(), consultation_id: consultationData.id, status: 'PENDING_REVIEW', created_at: new Date().toISOString() } }; if (response.success) { showToast('메뉴얼 초안이 생성되었습니다. 검토 페이지로 이동합니다.', 'success'); // 짧은 지연 후 초안 검토 페이지로 이동 setTimeout(() => { // TODO: 수동 초안 검토 페이지로 이동 // window.location.href = `/manuals/draft/${response.data.manual_draft_id}`; console.log('다음으로 이동:', `/manuals/draft/${response.data.manual_draft_id}`); }, 1500); } else { throw new Error('메뉴얼 초안 생성 실패'); } } catch (error) { console.error('초안 생성 오류:', error); showToast('메뉴얼 초안 생성 중 오류가 발생했습니다.', 'error'); // 버튼 상태 재설정 btn.disabled = false; btnText.innerHTML = ` <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"> <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path> <polyline points="14 2 14 8 20 8"></polyline> <line x1="12" y1="18" x2="12" y2="12"></line> <line x1="9" y1="15" x2="15" y2="15"></line> </svg> 메뉴얼 초안 생성 `; } } // 토스트 알림 기능 표시 showToast(message, type = 'success') { const toast = document.getElementById('toast'); const toastMessage = document.getElementById('toastMessage'); const toastIcon = document.getElementById('toastIcon'); toastMessage.textContent = message; toast.className = `toast ${type} show`; // 유형에 따라 아이콘 업데이트 if (type === 'success') { toastIcon.innerHTML = ` <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path> <polyline points="22 4 12 14.01 9 11.01"></polyline> `; } else { toastIcon.innerHTML = ` <circle cx="12" cy="12" r="10"></circle> <line x1="15" y1="9" x2="9" y2="15"></line> <line x1="9" y1="9" x2="15" y2="15"></line> `; } // 3초 후 자동으로 숨김 setTimeout(() => { toast.classList.remove('show'); }, 3000); } // 뒤로 가기 버튼 처리 function handleBack() { // TODO: 상담 목록으로 돌아가기 // window.history.back(); // 또는 // window.location.href = '/consultations'; console.log('상담 목록으로 돌아가기'); } // 로그아웃 처리 function handleLogout() { // TODO: API Connect - POST /api/auth/logout console.log('로그아웃 중...'); // window.location.href = '/login'; } // 로드 시 페이지 초기화 document.addEventListener('DOMContentLoaded', function() { initializePage(); });
    </script>
    <script>
      (function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('스크립트');d.innerHTML="window.__CF$cv$params={r:'9a914b6076759d6e',t:'MTc2NDkxNDEyNS4wMDAwMDA='};var a=document.createElement('스크립트');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].document.body에 child를 추가합니다(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.child를 추가합니다(a);if('로딩 중'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'로딩 중'!==document.onreadystate&&(document.onreadystatechange=e,c())}}}})();
    </script>
  </body>
</html>
